{% import "render_macros.j2" as macros %}

message {{+ self.name +}} {
{% if let Some(names) = self.render_reserved_names() ~%}
  {{+ names ~}}
{%~ endif %}

{%~ if let Some(numbers) = self.render_reserved_numbers() ~%}
  {{+ numbers ~}}
{%~ endif %}

{%~ if let Some(options) = self.render_options() ~%}
{{+ options }}
{% endif %}

{% for enum_ in enums %}
{%+ filter indent(2) ~%}
{{+ enum_.render()? +}}
{%~ endfilter %}
{%~ endfor %}

{% for nested_msg in messages %}
{%+ filter indent(2) ~%}
{{+ nested_msg.render()? +}}
{%+ endfilter %}
{% endfor %}

{% for entry in self.entries %}
{% match entry %}
  {%~ when MessageEntry::Oneof(oneof) +%}

  oneof {{+ oneof.name +}} {
    {% for option in oneof.options ~%}
    {{+ option.render() }}
    {% endfor +%}

    {% for field in oneof.fields ~%}
    {%+ call macros::render_field(field, self.package, 4) %}
    {% endfor +%}
  }
  {% when MessageEntry::Field(field) ~%}
  {%+ call macros::render_field(field, self.package, 2) %}
{% endmatch %}
{% endfor +%}
}
